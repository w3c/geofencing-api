<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Geofencing API</title>
  <link href="https://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet" type="text/css">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure);  }
 *        .example::before { content: "Example " counter(example); }
 *        .issue::before   { content: "Issue "   counter(issue);   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue); } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example); } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-style:  italic; }
	.toc > li li li li    { font-style:  normal; }
	.toc > li li li li li { font-style:  italic;
	                        font-size:   85%;    }

	.toc > li             { margin: 1.5rem 0;    }
	.toc > li li          { margin: 0.3rem 0;    }
	.toc > li li li       { margin-left: 2rem;   }

	/* Section numbers in a column of their own */
	.toc .secno {
		float: left;
		width: 4rem;
		white-space: nowrap;
	}
	.toc > li li li li .secno {
		font-size: 85%;
	}
	.toc > li li li li li .secno {
		font-size: 100%;
	}

	:not(li) > .toc              { margin-left:  5rem; }
	.toc .secno                  { margin-left: -5rem; }
	.toc > li li li .secno       { margin-left: -7rem; }
	.toc > li li li li .secno    { margin-left: -9rem; }
	.toc > li li li li li .secno { margin-left: -11rem; }

	/* Tighten up indentation in narrow ToCs */
	@media (max-width: 30em) {
		:not(li) > .toc              { margin-left:  4rem; }
		.toc .secno                  { margin-left: -4rem; }
		.toc > li li li              { margin-left:  1rem; }
		.toc > li li li .secno       { margin-left: -5rem; }
		.toc > li li li li .secno    { margin-left: -6rem; }
		.toc > li li li li li .secno { margin-left: -7rem; }
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) :not(li) > .toc              { margin-left:  4rem; }
		body:not(.toc-inline) .toc .secno                  { margin-left: -4rem; }
		body:not(.toc-inline) .toc > li li li              { margin-left:  1rem; }
		body:not(.toc-inline) .toc > li li li .secno       { margin-left: -5rem; }
		body:not(.toc-inline) .toc > li li li li .secno    { margin-left: -6rem; }
		body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	body.toc-sidebar #toc :not(li) > .toc              { margin-left:  4rem; }
	body.toc-sidebar #toc .toc .secno                  { margin-left: -4rem; }
	body.toc-sidebar #toc .toc > li li li              { margin-left:  1rem; }
	body.toc-sidebar #toc .toc > li li li .secno       { margin-left: -5rem; }
	body.toc-sidebar #toc .toc > li li li li .secno    { margin-left: -6rem; }
	body.toc-sidebar #toc .toc > li li li li li .secno { margin-left: -7rem; }

	.toc li {
		clear: both;
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}

/******************************************************************************/
/*                                  Bikeshed                                  */
/******************************************************************************/

	/* Style for paragraphs I know are in MD-genned lists */
	/* This is a weird hack for me not yet following the commonmark spec
	   regarding paragraph and lists. */
	[data-md] > :first-child {
		margin-top: 0;
	}
	[data-md] > :last-child {
		margin-bottom: 0;
	}

/** Inline CSS fragments ******************************************************/

	.css.css, .property.property, .descriptor.descriptor {
		color: #005a9c;
		font-size: inherit;
		font-family: inherit;
	}
	.css::before, .property::before, .descriptor::before {
		content: "‘";
	}
	.css::after, .property::after, .descriptor::after {
		content: "’";
	}
	.property, .descriptor {
		/* Don't wrap property and descriptor names */
		white-space: nowrap;
	}
	.type { /* CSS value <type> */
		font-style: italic;
	}
	pre .property::before, pre .property::after {
		content: "";
	}

/** Autolinks produced using Bikeshed *****************************************/

	[data-link-type]:not([data-link-type="dfn"]),
	[data-dfn-type]:not([data-dfn-type="dfn"]) {
		hyphens: none;
	}

	[data-link-type="property"]::before,
	[data-link-type="propdesc"]::before,
	[data-link-type="descriptor"]::before,
	[data-link-type="value"]::before,
	[data-link-type="function"]::before,
	[data-link-type="at-rule"]::before,
	[data-link-type="selector"]::before,
	[data-link-type="maybe"]::before {
		content: "‘";
	}
	[data-link-type="property"]::after,
	[data-link-type="propdesc"]::after,
	[data-link-type="descriptor"]::after,
	[data-link-type="value"]::after,
	[data-link-type="function"]::after,
	[data-link-type="at-rule"]::after,
	[data-link-type="selector"]::after,
	[data-link-type="maybe"]::after {
		content: "’";
	}

	[data-link-type].production::before,
	[data-link-type].production::after,
	.prod [data-link-type]::before,
	.prod [data-link-type]::after {
		content: "";
	}

	[data-link-type=element],
	[data-link-type=element-attr] {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
		font-size: .9em;
	}
	[data-link-type=element]::before { content: "<" }
	[data-link-type=element]::after  { content: ">" }

	[data-link-type=biblio] {
		white-space: pre;
	}

/** Self-Links ****************************************************************/
/* Auto-generated links from an element to its own anchor, for usability */

	.heading, .issue, .note, .example, li, dt {
		position: relative;
	}
	a.self-link {
		position: absolute;
		top: 0;
		left: calc(-1 * (3.5rem - 26px));
		width: calc(3.5rem - 26px);
		height: 2em;
		text-align: center;
		border: none;
		transition: opacity .2s;
		opacity: .5;
	}
	a.self-link:hover {
		opacity: 1;
	}
	.heading > a.self-link {
		font-size: 83%;
	}
	li > a.self-link {
		left: calc(-1 * (3.5rem - 26px) - 2em);
	}
	dfn > a.self-link {
		top: auto;
		left: auto;
		opacity: 0;
		width: 1.5em;
		height: 1.5em;
		background: gray;
		color: white;
		font-style: normal;
		transition: opacity .2s, background-color .2s, color .2s;
	}
	dfn:hover > a.self-link {
		opacity: 1;
	}
	dfn > a.self-link:hover {
		color: black;
	}

	a.self-link::before            { content: "¶"; }
	.heading > a.self-link::before { content: "§"; }
	dfn > a.self-link::before      { content: "#"; }

/** Counters ******************************************************************/
/* Adds the auto-genned issue/example counters,
   until Bikeshed fills in manual ones. */
	.issue:not(.no-marker)::before {
		content: "Issue " counter(issue);
	}

	.example:not(.no-marker)::before {
		content: "Example";
		content: "Example " counter(example);
	}
	.invalid.example:not(.no-marker)::before,
	.illegal.example:not(.no-marker)::before {
		content: "Invalid Example";
		content: "Invalid Example" counter(example);
	}



/********************************************
 Remember to fix the logo section when copypasting freshly.
 */
</style>
  <meta content="Bikeshed 1.0.0" name="generator">
<style>
        .dfn-panel {
            display: inline-block;
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel > span { display: list-item; list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: .5em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>.highlight .hll { background-color: #ffffcc }
.highlight  { background: #ffffff; }
.highlight .c { color: #708090 } /* Comment */
.highlight .k { color: #990055 } /* Keyword */
.highlight .l { color: #000000 } /* Literal */
.highlight .n { color: #0077aa } /* Name */
.highlight .o { color: #999999 } /* Operator */
.highlight .p { color: #999999 } /* Punctuation */
.highlight .cm { color: #708090 } /* Comment.Multiline */
.highlight .cp { color: #708090 } /* Comment.Preproc */
.highlight .c1 { color: #708090 } /* Comment.Single */
.highlight .cs { color: #708090 } /* Comment.Special */
.highlight .kc { color: #990055 } /* Keyword.Constant */
.highlight .kd { color: #990055 } /* Keyword.Declaration */
.highlight .kn { color: #990055 } /* Keyword.Namespace */
.highlight .kp { color: #990055 } /* Keyword.Pseudo */
.highlight .kr { color: #990055 } /* Keyword.Reserved */
.highlight .kt { color: #990055 } /* Keyword.Type */
.highlight .ld { color: #000000 } /* Literal.Date */
.highlight .m { color: #000000 } /* Literal.Number */
.highlight .s { color: #a67f59 } /* Literal.String */
.highlight .na { color: #0077aa } /* Name.Attribute */
.highlight .nc { color: #0077aa } /* Name.Class */
.highlight .no { color: #0077aa } /* Name.Constant */
.highlight .nd { color: #0077aa } /* Name.Decorator */
.highlight .ni { color: #0077aa } /* Name.Entity */
.highlight .ne { color: #0077aa } /* Name.Exception */
.highlight .nf { color: #0077aa } /* Name.Function */
.highlight .nl { color: #0077aa } /* Name.Label */
.highlight .nn { color: #0077aa } /* Name.Namespace */
.highlight .py { color: #0077aa } /* Name.Property */
.highlight .nt { color: #669900 } /* Name.Tag */
.highlight .nv { color: #0077aa } /* Name.Variable */
.highlight .ow { color: #999999 } /* Operator.Word */
.highlight .mb { color: #000000 } /* Literal.Number.Bin */
.highlight .mf { color: #000000 } /* Literal.Number.Float */
.highlight .mh { color: #000000 } /* Literal.Number.Hex */
.highlight .mi { color: #000000 } /* Literal.Number.Integer */
.highlight .mo { color: #000000 } /* Literal.Number.Oct */
.highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
.highlight .sc { color: #a67f59 } /* Literal.String.Char */
.highlight .sd { color: #a67f59 } /* Literal.String.Doc */
.highlight .s2 { color: #a67f59 } /* Literal.String.Double */
.highlight .se { color: #a67f59 } /* Literal.String.Escape */
.highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
.highlight .si { color: #a67f59 } /* Literal.String.Interpol */
.highlight .sx { color: #a67f59 } /* Literal.String.Other */
.highlight .sr { color: #a67f59 } /* Literal.String.Regex */
.highlight .s1 { color: #a67f59 } /* Literal.String.Single */
.highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
.highlight .vc { color: #0077aa } /* Name.Variable.Class */
.highlight .vg { color: #0077aa } /* Name.Variable.Global */
.highlight .vi { color: #0077aa } /* Name.Variable.Instance */
.highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
        .highlight { background: hsl(24, 20%, 95%); }
        code.highlight { padding: .1em; border-radius: .3em; }
        pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
        </style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Geofencing API</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2016-05-11">11 May 2016</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/geofencing-api/">https://w3c.github.io/geofencing-api/</a>
     <dt>Latest version:
     <dd><a href="http://www.w3.org/TR/geofencing/">http://www.w3.org/TR/geofencing/</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-geolocation@w3.org?subject=%5Bgeofencing-api%5D%20YOUR%20TOPIC%20HERE">public-geolocation@w3.org</a> with subject line “<kbd>[geofencing-api] <i data-lt="">… message topic …</i></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-geolocation/" rel="discussion">archives</a>)</span>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/w3c/geofencing-api/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:mek@chromium.org">Marijn Kruisselbrink</a> (<span class="p-org org">Google</span>)
    </dl>
   </div>
   <div data-fill-with="warning">
    <details class="annoying-warning" open="">
     <summary>Obsoletion Notice</summary>
     <p> This specification is not being actively maintained,
  	and should not be used as a guide for implementations.
  	It may be revived in the future,
  	but for now should be considered obsolete. </p>
     <p> If you have questions or comments on this specification,
  	please send an email to the editors. </p>
    </details>
   </div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2016 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This specification defines an API that lets <a data-link-type="dfn" href="#webapp" title="webapp">webapps</a> setup geographic boundaries around specific locations and then receive notifications when the hosting device enters or leaves those areas.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at http://www.w3.org/TR/.</em> </p>
   <p> This document was published by the <a href="http://www.w3.org/2008/geolocation/">Geolocation Working Group</a> as an Editor’s Draft.          
  If you wish to make comments regarding this document, please send them to <a href="mailto:public-geolocation@w3.org?subject=%5Bgeofencing-api%5D%20PUT%20SUBJECT%20HERE">public-geolocation@w3.org</a> (<a href="mailto:public-geolocation-request@w3.org?subject=subscribe">subscribe</a>, <a href="http://lists.w3.org/Archives/Public/public-geolocation/">archives</a>)
  with <code>[geofencing-api]</code> at the start of your email’s subject.
  All comments are welcome. </p>
   <p> Publication as an Editor’s Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may be updated, replaced or obsoleted by other
  documents at any time. It is inappropriate to cite this document as other than work in
  progress. </p>
   <p> This document was produced by a group operating under
        the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
        W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
        that page also includes instructions for disclosing a patent.
        An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="http://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">1 September 2015 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#examples"><span class="secno">1.1</span> <span class="content">Examples</span></a>
     </ol>
    <li>
     <a href="#model"><span class="secno">2</span> <span class="content">Model</span></a>
     <ol class="toc">
      <li><a href="#implementation considerations"><span class="secno">2.1</span> <span class="content">Implementation considerations</span></a>
     </ol>
    <li>
     <a href="#security-and-privacy-considerations"><span class="secno">3</span> <span class="content">Security and privacy considerations</span></a>
     <ol class="toc">
      <li><a href="#privacy-considerations-for-implementers-of-the-geofencing-api"><span class="secno">3.1</span> <span class="content"> Privacy considerations for implementers of the Geofencing API </span></a>
      <li><a href="#privacy-considerations-for-recipients-of-location-information"><span class="secno">3.2</span> <span class="content"> Privacy considerations for recipients of location information </span></a>
      <li><a href="#additional-implementation-considerations"><span class="secno">3.3</span> <span class="content"> Additional implementation considerations </span></a>
     </ol>
    <li>
     <a href="#api-description"><span class="secno">4</span> <span class="content">API Description</span></a>
     <ol class="toc">
      <li><a href="#extensions-to-the-serviceworkerregistration-interface"><span class="secno">4.1</span> <span class="content"> Extensions to the <code class="idl"><span>ServiceWorkerRegistration</span></code> interface </span></a>
      <li><a href="#geofencemanager-interface"><span class="secno">4.2</span> <span class="content"><code class="idl"><span>GeofenceManager</span></code> interface</span></a>
      <li><a href="#geofence-interface"><span class="secno">4.3</span> <span class="content"><code class="idl"><span>Geofence</span></code> interface</span></a>
      <li><a href="#geofenceregion-interface"><span class="secno">4.4</span> <span class="content"><code class="idl"><span>GeofenceRegion</span></code> interface</span></a>
      <li><a href="#circulargeofenceregion-interface"><span class="secno">4.5</span> <span class="content"><code class="idl"><span>CircularGeofenceRegion</span></code> interface</span></a>
      <li>
       <a href="#events"><span class="secno">4.6</span> <span class="content">Events</span></a>
       <ol class="toc">
        <li><a href="#the-geofenceenter-and-geofenceleave-events"><span class="secno">4.6.1</span> <span class="content"> The <code>geofenceenter</code> and <code>geofenceleave</code> events </span></a>
        <li><a href="#geofenceerrorevent-section"><span class="secno">4.6.2</span> <span class="content"><code class="idl"><span>GeofenceErrorEvent</span></code></span></a>
       </ol>
     </ol>
    <li><a href="#exceptions"><span class="secno">5</span> <span class="content">Exceptions</span></a>
    <li>
     <a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>The Geofencing API lets <a data-link-type="dfn" href="#webapp" id="ref-for-webapp-1" title="webapp">webapps</a> set up geographic boundaries around
  specific locations and then receive notifications when the hosting device enters or leaves
  those areas. While it would be possible to implement something similar using the
  Geolocation API <a data-link-type="biblio" href="#biblio-geolocation-api">[GEOLOCATION-API]</a>, there are a few differences that could make this API
  a better choice:</p>
    <ul>
     <li data-md="">
      <p>Because of the limited API surface of the Geofencing API, <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-1">user
agents</a> can implement the API in a more (power) efficient way than could be achieved by
regularly checking the current geographic position with the Geolocation API.</p>
     <li data-md="">
      <p>The Geofencing API is built around Service Workers. This makes it possible for a <a data-link-type="dfn" href="#webapp" id="ref-for-webapp-2">webapp</a> to receive notifications from the Geofencing API even after the user has
closed the <a data-link-type="dfn" href="#webapp" id="ref-for-webapp-3">webapp</a>.</p>
    </ul>
    <section>
     <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>
     <p>The following code extracts illustrate how to use this API to be notified of geographic
    regions being entered or left.</p>
     <div class="example" id="example-c82508e5">
      <a class="self-link" href="#example-c82508e5"></a> Monitor a region: 
<pre class="highlight"><span class="c1">// https://example.com/webapp.js</span>
<span class="nx">navigator</span><span class="p">.</span><span class="nx">serviceWorker</span>
  <span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="s1">'serviceworker.js'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">swRegistration</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">region</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CircularGeofenceRegion</span><span class="p">({</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s1">'myfence'</span><span class="p">,</span>
      <span class="nx">latitude</span><span class="o">:</span> <span class="mf">37.421999</span><span class="p">,</span>
      <span class="nx">longitude</span><span class="o">:</span> <span class="o">-</span><span class="mf">122.084015</span><span class="p">,</span>
      <span class="nx">radius</span><span class="o">:</span> <span class="mi">1000</span>
    <span class="p">});</span>
    <span class="kd">let</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">includePosition</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">};</span>
    <span class="nx">swRegistration</span><span class="p">.</span><span class="nx">geofencing</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">region</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">(</span>
        <span class="c1">// If more than just a name needs to be stored with a geofence, now</span>
        <span class="c1">// would be the time to store this in some storage.</span>
        <span class="p">(</span><span class="nx">geofence</span><span class="p">)</span> <span class="o">=></span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">geofence</span><span class="p">.</span><span class="nx">id</span><span class="p">),</span>
        <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="o">=></span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
      <span class="p">);</span>
<span class="p">});</span></pre>
     </div>
     <div class="example" id="example-745d4965">
      <a class="self-link" href="#example-745d4965"></a> Respond to a region being entered: 
<pre class="highlight"><span class="c1">// https://example.com/serviceworker.js</span>
<span class="nx">self</span><span class="p">.</span><span class="nx">ongeofenceenter</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">geofence</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">geofence</span><span class="p">.</span><span class="nx">region</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>

  <span class="c1">// If this is not a geofence of interest anymore, remove it.</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">geofence</span><span class="p">.</span><span class="nx">region</span><span class="p">.</span><span class="nx">name</span> <span class="o">!==</span> <span class="s2">"myfence"</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">waitUntil</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">geofence</span><span class="p">.</span><span class="nx">remove</span><span class="p">());</span>
  <span class="p">}</span>
<span class="p">};</span></pre>
     </div>
     <div class="example" id="example-078f4f93">
      <a class="self-link" href="#example-078f4f93"></a> Respond to an error condition: 
<pre class="highlight"><span class="c1">// https://example.com/serviceworker.js</span>
<span class="nx">self</span><span class="p">.</span><span class="nx">ongeofenceerror</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">geofence</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">geofence</span><span class="p">.</span><span class="nx">region</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>

  <span class="c1">// Some error condition occurred. The region is no longer monitored, and won’t</span>
  <span class="c1">// trigger any more events.</span>

  <span class="c1">// Try to re-monitor, although depending on the error this might fail.</span>
  <span class="nx">event</span>
    <span class="p">.</span><span class="nx">waitUntil</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">registration</span><span class="p">.</span><span class="nx">geofencing</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">geofence</span><span class="p">.</span><span class="nx">region</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">geofence</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
      <span class="c1">// re-monitoring succeeded, new geofence will have a different ID.</span>
    <span class="p">},</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
      <span class="c1">// re-monitoring failed.</span>
    <span class="p">});</span>
<span class="p">};</span></pre>
     </div>
     <div class="example" id="example-fa42d2b7">
      <a class="self-link" href="#example-fa42d2b7"></a> Stop monitoring a region in response to some other event: 
<pre class="highlight"><span class="c1">// https://example.com/serviceworker.js</span>

<span class="c1">// Either look geofence up by name:</span>
<span class="nx">self</span><span class="p">.</span><span class="nx">onsomeevent</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="nx">event</span>
    <span class="p">.</span><span class="nx">waitUntil</span><span class="p">(</span>
      <span class="nx">self</span><span class="p">.</span><span class="nx">registration</span><span class="p">.</span><span class="nx">geofencing</span><span class="p">.</span><span class="nx">getAll</span><span class="p">({</span>
        <span class="nx">name</span><span class="o">:</span> <span class="s1">'myfence'</span>
      <span class="p">})</span>
    <span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span>
      <span class="nx">geofences</span> <span class="o">=></span> <span class="nx">geofences</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">fence</span> <span class="o">=></span> <span class="nx">fence</span><span class="p">.</span><span class="nx">remove</span><span class="p">())</span>
    <span class="p">);</span>
<span class="p">};</span>

<span class="c1">// Or look geofence up by ID:</span>
<span class="nx">self</span><span class="p">.</span><span class="nx">onsomeotherevent</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=></span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">geofence_id</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span> <span class="cm">/* somehow get the ID of a geofence */</span>
  <span class="nx">event</span>
    <span class="p">.</span><span class="nx">waitUntil</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">registration</span><span class="p">.</span><span class="nx">geofencing</span><span class="p">.</span><span class="nx">getById</span><span class="p">(</span><span class="nx">geofence_id</span><span class="p">))</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">geofence</span> <span class="o">=></span> <span class="nx">geofence</span><span class="p">.</span><span class="nx">remove</span><span class="p">());</span>
<span class="p">};</span></pre>
     </div>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="model"><span class="secno">2. </span><span class="content">Model</span><a class="self-link" href="#model"></a></h2>
    <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="webapp" data-noexport="" id="webapp">webapp<span class="dfn-panel" data-deco=""><b><a href="#webapp">#webapp</a></b><b>Referenced in:</b><span><a href="#ref-for-webapp-1">1. Introduction</a> <a href="#ref-for-webapp-2">(2)</a> <a href="#ref-for-webapp-3">(3)</a></span><span><a href="#ref-for-webapp-4">3.1. 
      Privacy considerations for implementers of the Geofencing API </a></span><span><a href="#ref-for-webapp-5">4.2. GeofenceManager interface</a> <a href="#ref-for-webapp-6">(2)</a> <a href="#ref-for-webapp-7">(3)</a></span></span></dfn> refers to a Web application, i.e. an application implemented
  using Web technologies, and executing within the context of a Web <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-2">user agent</a>, e.g. a
  Web browser or other Web runtime environment.</p>
    <p>A <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="list of geofences" data-noexport="" id="list-of-geofences">list of geofences<span class="dfn-panel" data-deco=""><b><a href="#list-of-geofences">#list-of-geofences</a></b><b>Referenced in:</b><span><a href="#ref-for-list-of-geofences-1">2. Model</a></span><span><a href="#ref-for-list-of-geofences-2">2.1. Implementation considerations</a> <a href="#ref-for-list-of-geofences-3">(2)</a></span><span><a href="#ref-for-list-of-geofences-4">4.2. GeofenceManager interface</a> <a href="#ref-for-list-of-geofences-5">(2)</a> <a href="#ref-for-list-of-geofences-6">(3)</a> <a href="#ref-for-list-of-geofences-7">(4)</a></span><span><a href="#ref-for-list-of-geofences-8">4.3. Geofence interface</a> <a href="#ref-for-list-of-geofences-9">(2)</a></span></span></dfn> whose element
  type is a <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-1">geofence</a>.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="geofence" data-noexport="" id="geofence-term">geofence<span class="dfn-panel" data-deco=""><b><a href="#geofence-term">#geofence-term</a></b><b>Referenced in:</b><span><a href="#ref-for-geofence-term-1">2. Model</a> <a href="#ref-for-geofence-term-2">(2)</a> <a href="#ref-for-geofence-term-3">(3)</a> <a href="#ref-for-geofence-term-4">(4)</a> <a href="#ref-for-geofence-term-5">(5)</a> <a href="#ref-for-geofence-term-6">(6)</a> <a href="#ref-for-geofence-term-7">(7)</a> <a href="#ref-for-geofence-term-8">(8)</a> <a href="#ref-for-geofence-term-9">(9)</a> <a href="#ref-for-geofence-term-10">(10)</a></span><span><a href="#ref-for-geofence-term-11">3.1. 
      Privacy considerations for implementers of the Geofencing API </a> <a href="#ref-for-geofence-term-12">(2)</a> <a href="#ref-for-geofence-term-13">(3)</a> <a href="#ref-for-geofence-term-14">(4)</a></span><span><a href="#ref-for-geofence-term-15">4.2. GeofenceManager interface</a> <a href="#ref-for-geofence-term-16">(2)</a> <a href="#ref-for-geofence-term-17">(3)</a></span><span><a href="#ref-for-geofence-term-18">4.3. Geofence interface</a> <a href="#ref-for-geofence-term-19">(2)</a> <a href="#ref-for-geofence-term-20">(3)</a> <a href="#ref-for-geofence-term-21">(4)</a> <a href="#ref-for-geofence-term-22">(5)</a></span><span><a href="#ref-for-geofence-term-23">4.6.1. 
        The geofenceenter and geofenceleave events </a></span><span><a href="#ref-for-geofence-term-24">4.6.2. GeofenceErrorEvent</a></span></span></dfn> is one specific registration of a geograhpic region as a geofence.</p>
    <p>A <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-2">geofence</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="geofence name" data-noexport="" id="geofence-name">name<span class="dfn-panel" data-deco=""><b><a href="#geofence-name">#geofence-name</a></b><b>Referenced in:</b><span><a href="#ref-for-geofence-name-1">2.1. Implementation considerations</a></span><span><a href="#ref-for-geofence-name-2">4.2. GeofenceManager interface</a></span></span></dfn> (a string).</p>
    <p>A <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-3">geofence</a> has an associated <a data-link-type="dfn" href="#geographic-region" id="ref-for-geographic-region-1">geographic region</a>.</p>
    <p>A <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-4">geofence</a> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="geofence ID" data-noexport="" id="geofence-id">geofence ID<span class="dfn-panel" data-deco=""><b><a href="#geofence-id">#geofence-id</a></b><b>Referenced in:</b><span><a href="#ref-for-geofence-id-1">4.2. GeofenceManager interface</a> <a href="#ref-for-geofence-id-2">(2)</a></span><span><a href="#ref-for-geofence-id-3">4.3. Geofence interface</a></span></span></dfn>, a string uniquely identifying it. This ID is
  generated by the user agent and MUST be unique among all <a data-link-type="dfn" href="#list-of-geofences" id="ref-for-list-of-geofences-1">geofences</a> associated with all <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registrations</a> at the
  same origin. A user agent SHOULD NOT reuse the ID from an old <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-5">geofence</a> for a new
  one.</p>
    <p>A <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-6">geofence</a> has an <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="include position" data-noexport="" id="include-position">include position<span class="dfn-panel" data-deco=""><b><a href="#include-position">#include-position</a></b><b>Referenced in:</b><span><a href="#ref-for-include-position-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-include-position-2">4.6.1. 
        The geofenceenter and geofenceleave events </a></span></span></dfn> flag, a boolean indicating if events
  associated with this <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-7">geofence</a> should include the exact geographic position.</p>
    <p>A <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-8">geofence</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="state" data-noexport="" id="state">state<span class="dfn-panel" data-deco=""><b><a href="#state">#state</a></b><b>Referenced in:</b><span><a href="#ref-for-state-1">3.1. 
      Privacy considerations for implementers of the Geofencing API </a></span><span><a href="#ref-for-state-2">4.2. GeofenceManager interface</a> <a href="#ref-for-state-3">(2)</a></span><span><a href="#ref-for-state-4">4.3. Geofence interface</a></span><span><a href="#ref-for-state-5">4.6.2. GeofenceErrorEvent</a> <a href="#ref-for-state-6">(2)</a></span></span></dfn>, which is one of <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="active" data-noexport="" id="active">active<span class="dfn-panel" data-deco=""><b><a href="#active">#active</a></b><b>Referenced in:</b><span><a href="#ref-for-active-1">2. Model</a></span><span><a href="#ref-for-active-2">3.1. 
      Privacy considerations for implementers of the Geofencing API </a></span><span><a href="#ref-for-active-3">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-active-4">4.6.2. GeofenceErrorEvent</a></span></span></dfn> or <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="inactive" data-noexport="" id="inactive">inactive<span class="dfn-panel" data-deco=""><b><a href="#inactive">#inactive</a></b><b>Referenced in:</b><span><a href="#ref-for-inactive-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-inactive-2">4.3. Geofence interface</a></span><span><a href="#ref-for-inactive-3">4.6.2. GeofenceErrorEvent</a></span></span></dfn>.</p>
    <p>The <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-3">user agent</a> SHOULD be monitoring all <a data-link-type="dfn" href="#active" id="ref-for-active-1">active</a> <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-9">geofences</a> for <a data-link-type="dfn" href="#breached" id="ref-for-breached-1">breach</a> events.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="geographic region" data-noexport="" id="geographic-region">geographic region<span class="dfn-panel" data-deco=""><b><a href="#geographic-region">#geographic-region</a></b><b>Referenced in:</b><span><a href="#ref-for-geographic-region-1">2. Model</a> <a href="#ref-for-geographic-region-2">(2)</a></span><span><a href="#ref-for-geographic-region-3">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-geographic-region-4">4.3. Geofence interface</a></span></span></dfn> is a circular region defined by a <a data-link-type="dfn" href="#geographic-coordinate" id="ref-for-geographic-coordinate-1">geographic
  coordinate</a> representing the center of the region and a <dfn data-dfn-type="dfn" data-noexport="" id="radius">radius<a class="self-link" href="#radius"></a></dfn> representing
  the size of the region.</p>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="geographic coordinate" data-noexport="" id="geographic-coordinate">geographic coordinate<span class="dfn-panel" data-deco=""><b><a href="#geographic-coordinate">#geographic-coordinate</a></b><b>Referenced in:</b><span><a href="#ref-for-geographic-coordinate-1">2. Model</a></span></span></dfn> reference system used by the attributes in this API is
  the World Geodetic System (2d) <a data-link-type="biblio" href="#biblio-wgs84">[WGS84]</a>. No other reference system is supported.</p>
    <p>A <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-10">geofence</a> is said to be <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="breached" data-noexport="" id="breached">breached<span class="dfn-panel" data-deco=""><b><a href="#breached">#breached</a></b><b>Referenced in:</b><span><a href="#ref-for-breached-1">2. Model</a></span><span><a href="#ref-for-breached-2">3.1. 
      Privacy considerations for implementers of the Geofencing API </a></span><span><a href="#ref-for-breached-3">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-breached-4">4.6.1. 
        The geofenceenter and geofenceleave events </a> <a href="#ref-for-breached-5">(2)</a> <a href="#ref-for-breached-6">(3)</a> <a href="#ref-for-breached-7">(4)</a> <a href="#ref-for-breached-8">(5)</a></span></span></dfn> if the current geographical location
  changed from being inside the <a data-link-type="dfn" href="#geographic-region" id="ref-for-geographic-region-2">geographic region</a> to outside (a <dfn data-dfn-type="dfn" data-noexport="" id="leave-event">leave
  event<a class="self-link" href="#leave-event"></a></dfn>), or vice versa (an <dfn data-dfn-type="dfn" data-noexport="" id="enter-event">enter event<a class="self-link" href="#enter-event"></a></dfn>).</p>
    <section>
     <h3 class="heading settled" data-level="2.1" id="implementation considerations"><span class="secno">2.1. </span><span class="content">Implementation considerations</span><a class="self-link" href="#implementation%20considerations"></a></h3>
     <p>A <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-4">user agent</a> MAY impose <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="name limit" data-noexport="" id="name-limit">limits<span class="dfn-panel" data-deco=""><b><a href="#name-limit">#name-limit</a></b><b>Referenced in:</b><span><a href="#ref-for-name-limit-1">4.2. GeofenceManager interface</a></span></span></dfn> on the maximum size of a <a data-link-type="dfn" href="#geofence-name" id="ref-for-geofence-name-1">geofence name</a>. If a limit is imposed, this limit SHOULD allow for at least 100 characters.</p>
     <p>A <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-5">user agent</a> MAY impose <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="geofence limit" data-noexport="" id="geofence-limit">limits<span class="dfn-panel" data-deco=""><b><a href="#geofence-limit">#geofence-limit</a></b><b>Referenced in:</b><span><a href="#ref-for-geofence-limit-1">4.2. GeofenceManager interface</a></span></span></dfn> on the total number of <a data-link-type="dfn" href="#list-of-geofences" id="ref-for-list-of-geofences-2">geofences</a> that can be registered by a single origin. If a
    limit is imposed, this limit SHOULD allow at least 20 <a data-link-type="dfn" href="#list-of-geofences" id="ref-for-list-of-geofences-3">geofences</a> to be registered on a single origin.</p>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="security-and-privacy-considerations"><span class="secno">3. </span><span class="content">Security and privacy considerations</span><a class="self-link" href="#security-and-privacy-considerations"></a></h2>
    <p>The same <a href="http://www.w3.org/TR/geolocation-API/#security">security and privacy
  considerations</a> that apply to the Geolocation API <a data-link-type="biblio" href="#biblio-geolocation-api">[GEOLOCATION-API]</a> also apply to
  this API. Furthermore since this API effectively gives access to geographic location
  information after a user has stopped interacting with a webapp, a few other considerations
  should be taken into account.</p>
    <section>
     <h3 class="heading settled" data-level="3.1" id="privacy-considerations-for-implementers-of-the-geofencing-api"><span class="secno">3.1. </span><span class="content"> Privacy considerations for implementers of the Geofencing API </span><a class="self-link" href="#privacy-considerations-for-implementers-of-the-geofencing-api"></a></h3>
     <p><a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-6">User agents</a> MUST NOT provide Geofencing API access to <a data-link-type="dfn" href="#webapp" id="ref-for-webapp-4">webapps</a> without the express permission of the user. <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-7">User agents</a> MUST acquire consent for permission through a user
    interface for each call to the <code class="idl"><a data-link-type="idl" href="#dom-geofencemanager-add" id="ref-for-dom-geofencemanager-add-1">add(initialRegion, options)</a></code> method, unless a
    previous permission grant has been persisted, or a prearranged trust relationship applies.
    Permissions that are preserved beyond the current browsing session MUST be revocable.</p>
     <p>The <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-8">user agent</a> MAY consider the <code class="idl"><a data-link-type="idl" href="#geofenceregion" id="ref-for-geofenceregion-1">GeofenceRegion</a></code> and/or the <code class="idl"><a data-link-type="idl" href="#dictdef-geofenceoptions" id="ref-for-dictdef-geofenceoptions-1">GeofenceOptions</a></code> when
    acquiring permission or determining the permission status.</p>
     <p>When a permission is revoked, all <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-11">geofences</a> added with that permission
    MUST be <a data-link-type="dfn" href="#deactivated" id="ref-for-deactivated-1">deactivated</a>.</p>
     <p>When permission is granted for unlimited use of the Geofencing API by a <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker
    registration</a>, the <a data-link-type="dfn" href="#state" id="ref-for-state-1">state</a> of all associated <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-12">geofences</a> SHOULD
    be set to <a data-link-type="dfn" href="#active" id="ref-for-active-2">active</a>, and the <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-9">user agent</a> SHOULD start monitoring these <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-13">geofences</a> for <a data-link-type="dfn" href="#breached" id="ref-for-breached-2">breach</a> events.</p>
     <p>When a <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a> is unregistered, any associated <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-14">geofences</a> MUST be <a data-link-type="dfn" href="#deactivated" id="ref-for-deactivated-2">deactivated</a>.</p>
     <p><a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-10">User agents</a> MUST allow access to the Geofencing API from <a data-link-type="dfn" href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">secure contexts</a> only.</p>
     <p class="issue" id="issue-4cdf3c60"><a class="self-link" href="#issue-4cdf3c60"></a> This should somehow mention how the [permissions] API is related to this.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.2" id="privacy-considerations-for-recipients-of-location-information"><span class="secno">3.2. </span><span class="content"> Privacy considerations for recipients of location information </span><a class="self-link" href="#privacy-considerations-for-recipients-of-location-information"></a></h3>
     <p>TODO</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.3" id="additional-implementation-considerations"><span class="secno">3.3. </span><span class="content"> Additional implementation considerations </span><a class="self-link" href="#additional-implementation-considerations"></a></h3>
     <p><em>This section is non-normative.</em></p>
     <p>TODO</p>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="api-description"><span class="secno">4. </span><span class="content">API Description</span><a class="self-link" href="#api-description"></a></h2>
    <section>
     <h3 class="heading settled" data-level="4.1" id="extensions-to-the-serviceworkerregistration-interface"><span class="secno">4.1. </span><span class="content"> Extensions to the <code class="idl"><a data-link-type="idl" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a></code> interface </span><a class="self-link" href="#extensions-to-the-serviceworkerregistration-interface"></a></h3>
     <p>The Service Worker specification defines a <code class="idl"><a data-link-type="idl" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a></code> interface, which
    this specification extends.</p>
<pre class="idl def">partial interface <a class="idl-code" data-link-type="interface" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofencemanager" id="ref-for-geofencemanager-1">GeofenceManager</a> <dfn class="idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="attribute" data-export="" data-readonly="" data-type="GeofenceManager " id="dom-serviceworkerregistration-geofencing">geofencing<a class="self-link" href="#dom-serviceworkerregistration-geofencing"></a></dfn>;
};
</pre>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.2" id="geofencemanager-interface"><span class="secno">4.2. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#geofencemanager" id="ref-for-geofencemanager-2">GeofenceManager</a></code> interface</span><a class="self-link" href="#geofencemanager-interface"></a></h3>
     <p>The <code class="idl"><a data-link-type="idl" href="#geofencemanager" id="ref-for-geofencemanager-3">GeofenceManager</a></code> interface defines operations that enable <a data-link-type="dfn" href="#webapp" id="ref-for-webapp-5" title="webapp">webapps</a> to establish access to geofencing services.</p>
<pre class="idl def">[NoInterfaceObject]
interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="GeofenceManager" id="geofencemanager">GeofenceManager<span class="dfn-panel" data-deco=""><b><a href="#geofencemanager">#geofencemanager</a></b><b>Referenced in:</b><span><a href="#ref-for-geofencemanager-1">4.1. 
      Extensions to the ServiceWorkerRegistration interface
    </a></span><span><a href="#ref-for-geofencemanager-2">4.2. GeofenceManager interface</a> <a href="#ref-for-geofencemanager-3">(2)</a> <a href="#ref-for-geofencemanager-4">(3)</a> <a href="#ref-for-geofencemanager-5">(4)</a> <a href="#ref-for-geofencemanager-6">(5)</a></span></span></dfn> {
  Promise&lt;<a data-link-type="idl-name" href="#geofence" id="ref-for-geofence-1">Geofence</a>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-add" id="ref-for-dom-geofencemanager-add-2">add</a>(<a data-link-type="idl-name" href="#geofenceregion" id="ref-for-geofenceregion-2">GeofenceRegion</a> <dfn class="idl-code" data-dfn-for="GeofenceManager/add(initialRegion, options), GeofenceManager/add(initialRegion)" data-dfn-type="argument" data-export="" id="dom-geofencemanager-add-initialregion-options-initialregion">initialRegion<a class="self-link" href="#dom-geofencemanager-add-initialregion-options-initialregion"></a></dfn>, optional <a data-link-type="idl-name" href="#dictdef-geofenceoptions" id="ref-for-dictdef-geofenceoptions-2">GeofenceOptions</a> <dfn class="idl-code" data-dfn-for="GeofenceManager/add(initialRegion, options), GeofenceManager/add(initialRegion)" data-dfn-type="argument" data-export="" id="dom-geofencemanager-add-initialregion-options-options">options<a class="self-link" href="#dom-geofencemanager-add-initialregion-options-options"></a></dfn>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#geofence" id="ref-for-geofence-2">Geofence</a>>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-getall" id="ref-for-dom-geofencemanager-getall-1">getAll</a>(optional <a data-link-type="idl-name" href="#dictdef-geofencequeryoptions" id="ref-for-dictdef-geofencequeryoptions-1">GeofenceQueryOptions</a> <dfn class="idl-code" data-dfn-for="GeofenceManager/getAll(options), GeofenceManager/getAll()" data-dfn-type="argument" data-export="" id="dom-geofencemanager-getall-options-options">options<a class="self-link" href="#dom-geofencemanager-getall-options-options"></a></dfn>);
  Promise&lt;<a data-link-type="idl-name" href="#geofence" id="ref-for-geofence-3">Geofence</a>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-getbyid" id="ref-for-dom-geofencemanager-getbyid-1">getById</a>(DOMString <dfn class="idl-code" data-dfn-for="GeofenceManager/getById(id)" data-dfn-type="argument" data-export="" id="dom-geofencemanager-getbyid-id-id">id<a class="self-link" href="#dom-geofencemanager-getbyid-id-id"></a></dfn>);
};

dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" data-lt="GeofenceOptions" id="dictdef-geofenceoptions">GeofenceOptions<span class="dfn-panel" data-deco=""><b><a href="#dictdef-geofenceoptions">#dictdef-geofenceoptions</a></b><b>Referenced in:</b><span><a href="#ref-for-dictdef-geofenceoptions-1">3.1. 
      Privacy considerations for implementers of the Geofencing API
    </a></span><span><a href="#ref-for-dictdef-geofenceoptions-2">4.2. GeofenceManager interface</a></span></span></dfn> {
  boolean <a class="idl-code" data-default="false" data-link-type="dict-member" data-type="boolean " href="#dom-geofenceoptions-includeposition" id="ref-for-dom-geofenceoptions-includeposition-1">includePosition</a> = false;
};

dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" data-lt="GeofenceQueryOptions" id="dictdef-geofencequeryoptions">GeofenceQueryOptions<span class="dfn-panel" data-deco=""><b><a href="#dictdef-geofencequeryoptions">#dictdef-geofencequeryoptions</a></b><b>Referenced in:</b><span><a href="#ref-for-dictdef-geofencequeryoptions-1">4.2. GeofenceManager interface</a></span></span></dfn> {
  DOMString? <dfn class="idl-code" data-dfn-for="GeofenceQueryOptions" data-dfn-type="dict-member" data-export="" data-type="DOMString? " id="dom-geofencequeryoptions-name">name<a class="self-link" href="#dom-geofencequeryoptions-name"></a></dfn>;
};
</pre>
     <p>A <code class="idl"><a data-link-type="idl" href="#geofencemanager" id="ref-for-geofencemanager-4">GeofenceManager</a></code> has an associated <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>, represented by the <code class="idl"><a data-link-type="idl" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a></code> instance on which the <code class="idl"><a data-link-type="idl" href="#geofencemanager" id="ref-for-geofencemanager-5">GeofenceManager</a></code> was exposed.</p>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceManager" data-dfn-type="method" data-export="" data-lt="add(initialRegion, options)|add(initialRegion)" id="dom-geofencemanager-add" title="add(initialRegion, options)"> add(<var>initialRegion</var>, <var>options</var>)<span class="dfn-panel" data-deco=""><b><a href="#dom-geofencemanager-add">#dom-geofencemanager-add</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofencemanager-add-1">3.1. 
      Privacy considerations for implementers of the Geofencing API </a></span><span><a href="#ref-for-dom-geofencemanager-add-2">4.2. GeofenceManager interface</a></span></span></dfn></code> method when invoked MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>:</p>
     <ol>
      <li> Let <var>serviceWorkerRegistration</var> be the <code class="idl"><a data-link-type="idl" href="#geofencemanager" id="ref-for-geofencemanager-6">GeofenceManager</a></code>'s associated <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>. 
      <li> If <var>initialRegion</var> is not a <code class="idl"><a data-link-type="idl" href="#circulargeofenceregion" id="ref-for-circulargeofenceregion-1">CircularGeofenceRegion</a></code> instance, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-typeerror">TypeError</a></code>. 
      <li> If the length of the <code class="idl"><a data-link-type="idl" href="#dom-geofenceregion-name" id="ref-for-dom-geofenceregion-name-1">name</a></code> property of <var>initialRegion</var> exceeds a <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-11">user agent</a> defined <a data-link-type="dfn" href="#name-limit" id="ref-for-name-limit-1">limit</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-rangeerror">RangeError</a></code>. 
      <li> If the <code class="idl"><a data-link-type="idl" href="#dom-circulargeofenceregion-latitude" id="ref-for-dom-circulargeofenceregion-latitude-1">latitude</a></code> property of <var>initialRegion</var> is less than <code>-90</code> or greater than <code>90</code>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-rangeerror">RangeError</a></code>. 
      <li> If the <code class="idl"><a data-link-type="idl" href="#dom-circulargeofenceregion-longitude" id="ref-for-dom-circulargeofenceregion-longitude-1">longitude</a></code> property of <var>initialRegion</var> is less
        than <code>-180</code> or greater than <code>180</code>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-rangeerror">RangeError</a></code>. 
      <li> If the total number of <a data-link-type="dfn" href="#list-of-geofences" id="ref-for-list-of-geofences-4">geofences</a> for all <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registrations</a> in the current origin
        is more than the <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-12">user agent</a> defined <a data-link-type="dfn" href="#geofence-limit" id="ref-for-geofence-limit-1">limit</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl">QuotaExceededError</a></code> and terminate these substeps. 
      <li> Let <var>geofence</var> be a new <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-15">geofence</a>. 
      <li> Set the <a data-link-type="dfn" href="#geofence-id" id="ref-for-geofence-id-1">geofence ID</a> of <var>geofence</var> to a newly generated value. 
      <li> Set the <a data-link-type="dfn" href="#geographic-region" id="ref-for-geographic-region-3">geographic region</a> of <var>geofence</var> to a
        the region represented by <var>initialRegion</var>. 
      <li> Set the <a data-link-type="dfn" href="#include-position" id="ref-for-include-position-1">include position</a> flag of <var>geofence</var> to <var>options.includePosition</var>, or <code>false</code> if no options were
        specified. 
      <li> Set the <a data-link-type="dfn" href="#state" id="ref-for-state-2">state</a> of <var>geofence</var> to <a data-link-type="dfn" href="#inactive" id="ref-for-inactive-1">inactive</a>. 
      <li> Add <var>geofence</var> to the <a data-link-type="dfn" href="#list-of-geofences" id="ref-for-list-of-geofences-5">list of geofences</a> associated with <var>serviceWorkerRegistration</var>. 
      <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with a new <code class="idl"><a data-link-type="idl" href="#geofence" id="ref-for-geofence-4">Geofence</a></code> instance representing <var>geofence</var>. 
      <li> Ask the user whether they allow the <a data-link-type="dfn" href="#webapp" id="ref-for-webapp-6">webapp</a> to monitor geofences, unless a
        prearranged trust relationship applies or the user has already granted or denied
        permission explicitly for this <a data-link-type="dfn" href="#webapp" id="ref-for-webapp-7">webapp</a> to use this API. 
      <li>
        If permission is not granted, invoke the <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#handle-functional-event-algorithm">Handle Functional Event</a> algorithm with <var>serviceWorkerRegistration</var> and the algorithm represented by
        the following substeps as arguments. 
       <ol>
        <li> Let <var>globalObject</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object">global object</a> these steps are invoked with. 
        <li> Create a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-events-trusted">trusted</a> event <var>event</var> that uses the <code class="idl"><a data-link-type="idl" href="#geofenceerrorevent" id="ref-for-geofenceerrorevent-1">GeofenceErrorEvent</a></code> interface, with event type <code><a data-link-type="dfn" href="#geofenceerror" id="ref-for-geofenceerror-1">geofenceerror</a></code>. 
        <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceerrorevent-geofence" id="ref-for-dom-geofenceerrorevent-geofence-1">geofence</a></code> atrribute of <var>event</var> be initialized to
            a new <code class="idl"><a data-link-type="idl" href="#geofence" id="ref-for-geofence-5">Geofence</a></code> instance representing <var>geofence</var>. 
        <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceerrorevent-error" id="ref-for-dom-geofenceerrorevent-error-1">error</a></code> attribute of <var>event</var> be initialized to <code class="idl"><a data-link-type="idl">PermissionDeniedError</a></code>. 
        <li> Dispatch <var>event</var> at <var>globalObject</var>. 
       </ol>
      <li>
        Else if permission is granted, run the following substeps: 
       <ol>
        <li> Set the <a data-link-type="dfn" href="#state" id="ref-for-state-3">state</a> of <var>geofence</var> to <a data-link-type="dfn" href="#active" id="ref-for-active-3">active</a> and start monitoring the
            geofence for <a data-link-type="dfn" href="#breached" id="ref-for-breached-3">breach</a> events. 
        <li> If the current geographic position is inside the newly added region, <a data-link-type="dfn" href="#fire-a-geofence-event" id="ref-for-fire-a-geofence-event-1">fire a geofenceenter event</a>. 
       </ol>
     </ol>
     <p class="issue" id="issue-8ae02316"><a class="self-link" href="#issue-8ae02316"></a> Somehow mention that the region that is saved as part of the registration can be slightly
    different from the region passed to register. An implementation may adjust parameters to
    be in range of what is possible, or otherwise modify the region.</p>
     <p>If the <code><dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceOptions" data-dfn-type="dict-member" data-export="" data-lt="includePosition" id="dom-geofenceoptions-includeposition" title="includePosition">includePosition<span class="dfn-panel" data-deco=""><b><a href="#dom-geofenceoptions-includeposition">#dom-geofenceoptions-includeposition</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofenceoptions-includeposition-1">4.2. GeofenceManager interface</a></span></span></dfn></code> attribute is set to true, <code class="idl"><a data-link-type="idl" href="#geofenceevent" id="ref-for-geofenceevent-1">GeofenceEvent</a></code>s for this registration will have a <code class="idl"><a data-link-type="idl" href="#dom-geofenceevent-position" id="ref-for-dom-geofenceevent-position-1">position</a></code> attribute. When set to false, the <code class="idl"><a data-link-type="idl" href="#dom-geofenceevent-position" id="ref-for-dom-geofenceevent-position-2">position</a></code> attribute will always be undefined.</p>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceManager" data-dfn-type="method" data-export="" data-lt="getAll(options)|getAll()" id="dom-geofencemanager-getall" titlt="getAll(options)">getAll(<var>options</var>)<span class="dfn-panel" data-deco=""><b><a href="#dom-geofencemanager-getall">#dom-geofencemanager-getall</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofencemanager-getall-1">4.2. GeofenceManager interface</a></span></span></dfn></code> method when invoked MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>:</p>
     <ol>
      <li> Let <var>geofences</var> be a new <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a></code>. 
      <li>
        For each <var>geofence</var> <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-16">geofence</a> in the <a data-link-type="dfn" href="#list-of-geofences" id="ref-for-list-of-geofences-6">list of geofences</a> associated
        with this <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>, run the following substeps: 
       <ol>
        <li> If <var>options</var> is passed, has a non-null <var>name</var> attribute,
            and that <var>name</var> is not equal to the <a data-link-type="dfn" href="#geofence-name" id="ref-for-geofence-name-2">name</a> of the <var>geofence</var>, skip the rest of these substeps and continue with the next registration. 
        <li> Append a new <code class="idl"><a data-link-type="idl" href="#geofence" id="ref-for-geofence-6">Geofence</a></code> instance representing <var>geofence</var> to <var>geofences</var>. 
       </ol>
      <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <var>geofences</var>. 
     </ol>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceManager" data-dfn-type="method" data-export="" data-lt="getById(id)" id="dom-geofencemanager-getbyid" title="getById(id)">getById(<var>id</var>)<span class="dfn-panel" data-deco=""><b><a href="#dom-geofencemanager-getbyid">#dom-geofencemanager-getbyid</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofencemanager-getbyid-1">4.2. GeofenceManager interface</a></span></span></dfn></code> method when invoked MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following
    steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>:</p>
     <ol>
      <li>
        For each <var>geofence</var> <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-17">geofence</a> in the <a data-link-type="dfn" href="#list-of-geofences" id="ref-for-list-of-geofences-7">list of geofences</a> associated
        with this <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>, run the following substeps: 
       <ol>
        <li> If the <a data-link-type="dfn" href="#geofence-id" id="ref-for-geofence-id-2">geofence ID</a> of <var>geofence</var> is not equal to
            the passed in <var>id</var>, skip the rest of these substeps and continue with
            the next geofence. 
        <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with a new <code class="idl"><a data-link-type="idl" href="#geofence" id="ref-for-geofence-7">Geofence</a></code> instance representing <var>geofence</var>. 
       </ol>
      <li> If <var>promise</var> was not resolved, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a> <var>promise</var> with <code>null</code>. 
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.3" id="geofence-interface"><span class="secno">4.3. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#geofence" id="ref-for-geofence-8">Geofence</a></code> interface</span><a class="self-link" href="#geofence-interface"></a></h3>
     <p>An instance of the <code class="idl"><a data-link-type="idl" href="#geofence" id="ref-for-geofence-9">Geofence</a></code> interface represents a <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-18">geofence</a>.</p>
<pre class="idl def">[Exposed=(Window,Worker)]
interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="Geofence" id="geofence">Geofence<span class="dfn-panel" data-deco=""><b><a href="#geofence">#geofence</a></b><b>Referenced in:</b><span><a href="#ref-for-geofence-1">4.2. GeofenceManager interface</a> <a href="#ref-for-geofence-2">(2)</a> <a href="#ref-for-geofence-3">(3)</a> <a href="#ref-for-geofence-4">(4)</a> <a href="#ref-for-geofence-5">(5)</a> <a href="#ref-for-geofence-6">(6)</a> <a href="#ref-for-geofence-7">(7)</a></span><span><a href="#ref-for-geofence-8">4.3. Geofence interface</a> <a href="#ref-for-geofence-9">(2)</a> <a href="#ref-for-geofence-10">(3)</a></span><span><a href="#ref-for-geofence-11">4.6.1. 
        The geofenceenter and geofenceleave events
      </a> <a href="#ref-for-geofence-12">(2)</a></span><span><a href="#ref-for-geofence-13">4.6.2. GeofenceErrorEvent</a> <a href="#ref-for-geofence-14">(2)</a></span></span></dfn> {
  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-geofence-id" id="ref-for-dom-geofence-id-1">id</a>;
  readonly attribute <a data-link-type="idl-name" href="#geofenceregion" id="ref-for-geofenceregion-3">GeofenceRegion</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="GeofenceRegion " href="#dom-geofence-region" id="ref-for-dom-geofence-region-1">region</a>;
  Promise&lt;boolean> <a class="idl-code" data-link-type="method" href="#dom-geofence-remove" id="ref-for-dom-geofence-remove-1">remove</a>();
};
</pre>
     <p>When getting the <code><dfn class="dfn-paneled idl-code" data-dfn-for="Geofence" data-dfn-type="attribute" data-export="" data-lt="id" id="dom-geofence-id" title="id">id<span class="dfn-panel" data-deco=""><b><a href="#dom-geofence-id">#dom-geofence-id</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofence-id-1">4.3. Geofence interface</a></span></span></dfn></code> attribute, the <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-13">user
    agent</a> MUST return the <a data-link-type="dfn" href="#geofence-id" id="ref-for-geofence-id-3">geofence ID</a> of the <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-19">geofence</a>.</p>
     <p>When getting the <code><dfn class="dfn-paneled idl-code" data-dfn-for="Geofence" data-dfn-type="attribute" data-export="" data-lt="region" id="dom-geofence-region" title="region">region<span class="dfn-panel" data-deco=""><b><a href="#dom-geofence-region">#dom-geofence-region</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofence-region-1">4.3. Geofence interface</a></span></span></dfn></code> attribute, the <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-14">user agent</a> MUST return the <a data-link-type="dfn" href="#geographic-region" id="ref-for-geographic-region-4">geographic region</a> of this <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-20">geofence</a>.</p>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="Geofence" data-dfn-type="method" data-export="" data-lt="remove()" id="dom-geofence-remove" title="remove()">remove()<span class="dfn-panel" data-deco=""><b><a href="#dom-geofence-remove">#dom-geofence-remove</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofence-remove-1">4.3. Geofence interface</a></span></span></dfn></code> method when invoked
    MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>:</p>
     <ol>
      <li> Let <var>geofence</var> be the <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-21">geofence</a> represented by this <code class="idl"><a data-link-type="idl" href="#geofence" id="ref-for-geofence-10">Geofence</a></code> instance. 
      <li> If <var>geofence</var> is not currently in the <a data-link-type="dfn" href="#list-of-geofences" id="ref-for-list-of-geofences-8">list of geofences</a> associated with a <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a> <var>promise</var> with <code>false</code> and abort the remainder of these steps. 
      <li> Remove <var>geofence</var> from the <a data-link-type="dfn" href="#list-of-geofences" id="ref-for-list-of-geofences-9">list of geofences</a> associated
        with the current <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>. No more events related to this
        geofence will be fired after this. 
      <li> Set the <a data-link-type="dfn" href="#state" id="ref-for-state-4">state</a> of <var>geofence</var> to <a data-link-type="dfn" href="#inactive" id="ref-for-inactive-2">inactive</a>, but do not trigger the steps
        that are normally triggered when a <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-22">geofence</a> is <a data-link-type="dfn" href="#deactivated" id="ref-for-deactivated-3">deactivated</a>. 
      <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <code>true</code>. 
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.4" id="geofenceregion-interface"><span class="secno">4.4. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#geofenceregion" id="ref-for-geofenceregion-4">GeofenceRegion</a></code> interface</span><a class="self-link" href="#geofenceregion-interface"></a></h3>
<pre class="idl def">[Exposed=(Window,Worker)]
interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="GeofenceRegion" id="geofenceregion">GeofenceRegion<span class="dfn-panel" data-deco=""><b><a href="#geofenceregion">#geofenceregion</a></b><b>Referenced in:</b><span><a href="#ref-for-geofenceregion-1">3.1. 
      Privacy considerations for implementers of the Geofencing API
    </a></span><span><a href="#ref-for-geofenceregion-2">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-geofenceregion-3">4.3. Geofence interface</a></span><span><a href="#ref-for-geofenceregion-4">4.4. GeofenceRegion interface</a></span><span><a href="#ref-for-geofenceregion-5">4.5. CircularGeofenceRegion interface</a></span></span></dfn> {
  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-geofenceregion-name" id="ref-for-dom-geofenceregion-name-2">name</a>;
};

dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" data-lt="GeofenceRegionInit" id="dictdef-geofenceregioninit">GeofenceRegionInit<span class="dfn-panel" data-deco=""><b><a href="#dictdef-geofenceregioninit">#dictdef-geofenceregioninit</a></b><b>Referenced in:</b><span><a href="#ref-for-dictdef-geofenceregioninit-1">4.4. GeofenceRegion interface</a></span><span><a href="#ref-for-dictdef-geofenceregioninit-2">4.5. CircularGeofenceRegion interface</a></span></span></dfn> {
  DOMString? <dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceRegionInit" data-dfn-type="dict-member" data-export="" data-lt="name" data-type="DOMString? " id="dom-geofenceregioninit-name">name<span class="dfn-panel" data-deco=""><b><a href="#dom-geofenceregioninit-name">#dom-geofenceregioninit-name</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofenceregioninit-name-1">4.4. GeofenceRegion interface</a></span></span></dfn>;
};
</pre>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceRegion" data-dfn-type="attribute" data-export="" data-lt="name" id="dom-geofenceregion-name" title="name">name<span class="dfn-panel" data-deco=""><b><a href="#dom-geofenceregion-name">#dom-geofenceregion-name</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofenceregion-name-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-dom-geofenceregion-name-2">4.4. GeofenceRegion interface</a></span></span></dfn></code> attribute MUST return
    the value it was initialized to. When the object is created, this attribute MUST be set to the
    value of the <code class="idl"><a data-link-type="idl" href="#dom-geofenceregioninit-name" id="ref-for-dom-geofenceregioninit-name-1">name</a></code> property in the <code class="idl"><a data-link-type="idl" href="#dictdef-geofenceregioninit" id="ref-for-dictdef-geofenceregioninit-1">GeofenceRegionInit</a></code> dictionary, or
    an empty string if that property wasn’t set.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.5" id="circulargeofenceregion-interface"><span class="secno">4.5. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#circulargeofenceregion" id="ref-for-circulargeofenceregion-2">CircularGeofenceRegion</a></code> interface</span><a class="self-link" href="#circulargeofenceregion-interface"></a></h3>
<pre class="idl def">[<dfn class="idl-code" data-dfn-for="CircularGeofenceRegion" data-dfn-type="constructor" data-export="" data-lt="CircularGeofenceRegion(init)" id="dom-circulargeofenceregion-circulargeofenceregion">Constructor<a class="self-link" href="#dom-circulargeofenceregion-circulargeofenceregion"></a></dfn>(<a data-link-type="idl-name" href="#dictdef-circulargeofenceregioninit" id="ref-for-dictdef-circulargeofenceregioninit-1">CircularGeofenceRegionInit</a> <dfn class="idl-code" data-dfn-for="CircularGeofenceRegion/CircularGeofenceRegion(init)" data-dfn-type="argument" data-export="" id="dom-circulargeofenceregion-circulargeofenceregion-init-init">init<a class="self-link" href="#dom-circulargeofenceregion-circulargeofenceregion-init-init"></a></dfn>), Exposed=(Window,Worker)]
interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="CircularGeofenceRegion" id="circulargeofenceregion">CircularGeofenceRegion<span class="dfn-panel" data-deco=""><b><a href="#circulargeofenceregion">#circulargeofenceregion</a></b><b>Referenced in:</b><span><a href="#ref-for-circulargeofenceregion-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-circulargeofenceregion-2">4.5. CircularGeofenceRegion interface</a> <a href="#ref-for-circulargeofenceregion-3">(2)</a></span></span></dfn> : <a data-link-type="idl-name" href="#geofenceregion" id="ref-for-geofenceregion-5">GeofenceRegion</a> {
  readonly attribute double <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="double " href="#dom-circulargeofenceregion-latitude" id="ref-for-dom-circulargeofenceregion-latitude-2">latitude</a>;
  readonly attribute double <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="double " href="#dom-circulargeofenceregion-longitude" id="ref-for-dom-circulargeofenceregion-longitude-2">longitude</a>;
  readonly attribute double <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="double " href="#dom-circulargeofenceregion-radius" id="ref-for-dom-circulargeofenceregion-radius-1">radius</a>;
};

dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" data-lt="CircularGeofenceRegionInit" id="dictdef-circulargeofenceregioninit">CircularGeofenceRegionInit<span class="dfn-panel" data-deco=""><b><a href="#dictdef-circulargeofenceregioninit">#dictdef-circulargeofenceregioninit</a></b><b>Referenced in:</b><span><a href="#ref-for-dictdef-circulargeofenceregioninit-1">4.5. CircularGeofenceRegion interface</a></span></span></dfn> : <a data-link-type="idl-name" href="#dictdef-geofenceregioninit" id="ref-for-dictdef-geofenceregioninit-2">GeofenceRegionInit</a> {
  double <dfn class="idl-code" data-dfn-for="CircularGeofenceRegionInit" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-circulargeofenceregioninit-latitude">latitude<a class="self-link" href="#dom-circulargeofenceregioninit-latitude"></a></dfn>;
  double <dfn class="idl-code" data-dfn-for="CircularGeofenceRegionInit" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-circulargeofenceregioninit-longitude">longitude<a class="self-link" href="#dom-circulargeofenceregioninit-longitude"></a></dfn>;
  double <dfn class="idl-code" data-dfn-for="CircularGeofenceRegionInit" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-circulargeofenceregioninit-radius">radius<a class="self-link" href="#dom-circulargeofenceregioninit-radius"></a></dfn>;
};
</pre>
     <p>The <code class="idl"><a data-link-type="idl" href="#circulargeofenceregion" id="ref-for-circulargeofenceregion-3">CircularGeofenceRegion</a></code> constructor when invoked MUST initialize the properties of the
    newly created object to the corresponding attributes in the initializer.</p>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="CircularGeofenceRegion" data-dfn-type="attribute" data-export="" data-lt="latitude" id="dom-circulargeofenceregion-latitude" title="latitude">latitude<span class="dfn-panel" data-deco=""><b><a href="#dom-circulargeofenceregion-latitude">#dom-circulargeofenceregion-latitude</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-circulargeofenceregion-latitude-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-dom-circulargeofenceregion-latitude-2">4.5. CircularGeofenceRegion interface</a></span></span></dfn></code> attribute
    MUST return the value it was intialized to. This value represents the latitude in
    circular degrees of the center of the circular region.</p>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="CircularGeofenceRegion" data-dfn-type="attribute" data-export="" data-lt="longitude" id="dom-circulargeofenceregion-longitude" title="longitude">longitude<span class="dfn-panel" data-deco=""><b><a href="#dom-circulargeofenceregion-longitude">#dom-circulargeofenceregion-longitude</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-circulargeofenceregion-longitude-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-dom-circulargeofenceregion-longitude-2">4.5. CircularGeofenceRegion interface</a></span></span></dfn></code> attribute MUST return the value it was intialized to. This value represents the longitude
    in circular degrees of the center of the circular region.</p>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="CircularGeofenceRegion" data-dfn-type="attribute" data-export="" data-lt="radius" id="dom-circulargeofenceregion-radius" title="radius">radius<span class="dfn-panel" data-deco=""><b><a href="#dom-circulargeofenceregion-radius">#dom-circulargeofenceregion-radius</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-circulargeofenceregion-radius-1">4.5. CircularGeofenceRegion interface</a></span></span></dfn></code> attribute MUST
    return thev value it was initialized to. This value represents the radius in meters of the
    circular region.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.6" id="events"><span class="secno">4.6. </span><span class="content">Events</span><a class="self-link" href="#events"></a></h3>
     <p>The Service Worker specification defines a <code class="idl"><a data-link-type="idl" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-global-scope-interface">ServiceWorkerGlobalScope</a></code> interface, which this
    specification extends.</p>
<pre class="idl def">partial interface <a class="idl-code" data-link-type="interface" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-global-scope-interface">ServiceWorkerGlobalScope</a> {
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceenter" id="ref-for-dom-serviceworkerglobalscope-ongeofenceenter-1">ongeofenceenter</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceleave" id="ref-for-dom-serviceworkerglobalscope-ongeofenceleave-1">ongeofenceleave</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceerror" id="ref-for-dom-serviceworkerglobalscope-ongeofenceerror-1">ongeofenceerror</a>;
};
</pre>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute" data-export="" data-lt="ongeofenceenter" id="dom-serviceworkerglobalscope-ongeofenceenter" title="ongeofenceenter">ongeofenceenter<span class="dfn-panel" data-deco=""><b><a href="#dom-serviceworkerglobalscope-ongeofenceenter">#dom-serviceworkerglobalscope-ongeofenceenter</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-serviceworkerglobalscope-ongeofenceenter-1">4.6. Events</a></span></span></dfn></code> attribute is
    an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handler</a> whose corresponding <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event type</a> is <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="geofenceenter" data-noexport="" id="geofenceenter">geofenceenter<span class="dfn-panel" data-deco=""><b><a href="#geofenceenter">#geofenceenter</a></b><b>Referenced in:</b><span><a href="#ref-for-geofenceenter-1">4.6.1. 
        The geofenceenter and geofenceleave events </a></span></span></dfn></code>.</p>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute" data-export="" data-lt="ongeofenceleave" id="dom-serviceworkerglobalscope-ongeofenceleave" title="ongeofenceleave">ongeofenceleave<span class="dfn-panel" data-deco=""><b><a href="#dom-serviceworkerglobalscope-ongeofenceleave">#dom-serviceworkerglobalscope-ongeofenceleave</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-serviceworkerglobalscope-ongeofenceleave-1">4.6. Events</a></span></span></dfn></code> attribute is
    an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handler</a> whose corresponding <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event type</a> is <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="geofenceleave" data-noexport="" id="geofenceleave">geofenceleave<span class="dfn-panel" data-deco=""><b><a href="#geofenceleave">#geofenceleave</a></b><b>Referenced in:</b><span><a href="#ref-for-geofenceleave-1">4.6.1. 
        The geofenceenter and geofenceleave events </a></span></span></dfn></code>.</p>
     <p>The <code><dfn class="dfn-paneled idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute" data-export="" data-lt="ongeofenceerror" id="dom-serviceworkerglobalscope-ongeofenceerror" title="ongeofenceerror">ongeofenceerror<span class="dfn-panel" data-deco=""><b><a href="#dom-serviceworkerglobalscope-ongeofenceerror">#dom-serviceworkerglobalscope-ongeofenceerror</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-serviceworkerglobalscope-ongeofenceerror-1">4.6. Events</a></span></span></dfn></code> attribute is
    an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handler</a> whose corresponding <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event type</a> is <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="geofenceerror" data-noexport="" id="geofenceerror">geofenceerror<span class="dfn-panel" data-deco=""><b><a href="#geofenceerror">#geofenceerror</a></b><b>Referenced in:</b><span><a href="#ref-for-geofenceerror-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-geofenceerror-2">4.6.2. GeofenceErrorEvent</a></span></span></dfn></code>.</p>
     <section>
      <h4 class="heading settled" data-level="4.6.1" id="the-geofenceenter-and-geofenceleave-events"><span class="secno">4.6.1. </span><span class="content"> The <code>geofenceenter</code> and <code>geofenceleave</code> events </span><a class="self-link" href="#the-geofenceenter-and-geofenceleave-events"></a></h4>
      <p>The <code class="idl"><a data-link-type="idl" href="#geofenceevent" id="ref-for-geofenceevent-2">GeofenceEvent</a></code> interface represents a geofence being <a data-link-type="dfn" href="#breached" id="ref-for-breached-4">breached</a>.</p>
<pre class="idl def">[Exposed=ServiceWorker]
interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="GeofenceEvent" id="geofenceevent">GeofenceEvent<span class="dfn-panel" data-deco=""><b><a href="#geofenceevent">#geofenceevent</a></b><b>Referenced in:</b><span><a href="#ref-for-geofenceevent-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-geofenceevent-2">4.6.1. 
        The geofenceenter and geofenceleave events
      </a> <a href="#ref-for-geofenceevent-3">(2)</a></span></span></dfn> : <a data-link-type="idl-name" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#extendable-event-interface">ExtendableEvent</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofence" id="ref-for-geofence-11">Geofence</a> <dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceEvent" data-dfn-type="attribute" data-export="" data-lt="geofence" data-readonly="" data-type="Geofence " id="dom-geofenceevent-geofence">geofence<span class="dfn-panel" data-deco=""><b><a href="#dom-geofenceevent-geofence">#dom-geofenceevent-geofence</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofenceevent-geofence-1">4.6.1. 
        The geofenceenter and geofenceleave events
      </a></span></span></dfn>;
  readonly attribute <a data-link-type="idl-name" href="http://www.w3.org/TR/geolocation-API/#position_interface">Position</a>? <dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceEvent" data-dfn-type="attribute" data-export="" data-lt="position" data-readonly="" data-type="Position? " id="dom-geofenceevent-position">position<span class="dfn-panel" data-deco=""><b><a href="#dom-geofenceevent-position">#dom-geofenceevent-position</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofenceevent-position-1">4.2. GeofenceManager interface</a> <a href="#ref-for-dom-geofenceevent-position-2">(2)</a></span><span><a href="#ref-for-dom-geofenceevent-position-3">4.6.1. 
        The geofenceenter and geofenceleave events
      </a></span></span></dfn>;
};
</pre>
      <p>Upon detecting a <a data-link-type="dfn" href="#breached" id="ref-for-breached-5" title="breached">breach</a> of a <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-23">geofence</a> <var>geofence</var>,
      the <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-15">user agent</a> MUST run the following steps to <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="fire a geofence event" data-noexport="" id="fire-a-geofence-event">fire a geofence event<span class="dfn-panel" data-deco=""><b><a href="#fire-a-geofence-event">#fire-a-geofence-event</a></b><b>Referenced in:</b><span><a href="#ref-for-fire-a-geofence-event-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-fire-a-geofence-event-2">4.6.1. 
        The geofenceenter and geofenceleave events </a></span></span></dfn>:</p>
      <ol>
       <li> Let <var>serviceWorkerRegistration</var> be the <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a> <var>geofence</var> is associated with. 
       <li>
         Invoke the <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#handle-functional-event-algorithm">Handle Functional Event</a> algorithm with <var>serviceWorkerRegistration</var> and the algorithm represented by the following substeps as arguments. 
        <ol>
         <li> Let <var>globalObject</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object">global object</a> these steps are invoked with. 
         <li> Let <var>eventType</var> be <code><a data-link-type="dfn" href="#geofenceenter" id="ref-for-geofenceenter-1">geofenceenter</a></code> or <code><a data-link-type="dfn" href="#geofenceleave" id="ref-for-geofenceleave-1">geofenceleave</a></code>, corresponding to the type of <a data-link-type="dfn" href="#breached" id="ref-for-breached-6" title="breached">breach</a> event being processed. 
         <li> Create a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-events-trusted">trusted</a> event <var>event</var> that uses the <code class="idl"><a data-link-type="idl" href="#geofenceevent" id="ref-for-geofenceevent-3">GeofenceEvent</a></code> interface, with event type equal to <var>eventType</var>. 
         <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceevent-geofence" id="ref-for-dom-geofenceevent-geofence-1">geofence</a></code> atrribute of <var>event</var> be initialized to
              a new <code class="idl"><a data-link-type="idl" href="#geofence" id="ref-for-geofence-12">Geofence</a></code> instance representing <var>geofence</var>. 
         <li> If the <a data-link-type="dfn" href="#include-position" id="ref-for-include-position-2">include position</a> flag of <var>geofence</var> is true, set the <code class="idl"><a data-link-type="idl" href="#dom-geofenceevent-position" id="ref-for-dom-geofenceevent-position-3">position</a></code> attribute of <var>event</var> to the current geographical
              position. 
         <li> Dispatch <var>event</var> at <var>globalObject</var>. 
        </ol>
      </ol>
      <p>The <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-16">user agent</a> MAY delay <a data-link-type="dfn" href="#fire-a-geofence-event" id="ref-for-fire-a-geofence-event-2">firing a geofence
      event</a> until some time and/or distance has passed after the <a data-link-type="dfn" href="#breached" id="ref-for-breached-7" title="breached">breach</a> was detected to make sure that the geofence really was <a data-link-type="dfn" href="#breached" id="ref-for-breached-8">breached</a>.</p>
     </section>
     <section>
      <h4 class="heading settled" data-level="4.6.2" id="geofenceerrorevent-section"><span class="secno">4.6.2. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#geofenceerrorevent" id="ref-for-geofenceerrorevent-2">GeofenceErrorEvent</a></code></span><a class="self-link" href="#geofenceerrorevent-section"></a></h4>
<pre class="idl def">[Exposed=ServiceWorker]
interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="GeofenceErrorEvent" id="geofenceerrorevent">GeofenceErrorEvent<span class="dfn-panel" data-deco=""><b><a href="#geofenceerrorevent">#geofenceerrorevent</a></b><b>Referenced in:</b><span><a href="#ref-for-geofenceerrorevent-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-geofenceerrorevent-2">4.6.2. GeofenceErrorEvent</a> <a href="#ref-for-geofenceerrorevent-3">(2)</a></span></span></dfn> : <a data-link-type="idl-name" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#extendable-event-interface">ExtendableEvent</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofence" id="ref-for-geofence-13">Geofence</a> <dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceErrorEvent" data-dfn-type="attribute" data-export="" data-lt="geofence" data-readonly="" data-type="Geofence " id="dom-geofenceerrorevent-geofence">geofence<span class="dfn-panel" data-deco=""><b><a href="#dom-geofenceerrorevent-geofence">#dom-geofenceerrorevent-geofence</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofenceerrorevent-geofence-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-dom-geofenceerrorevent-geofence-2">4.6.2. GeofenceErrorEvent</a></span></span></dfn>;
  readonly attribute DOMString <dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceErrorEvent" data-dfn-type="attribute" data-export="" data-lt="error" data-readonly="" data-type="DOMString " id="dom-geofenceerrorevent-error">error<span class="dfn-panel" data-deco=""><b><a href="#dom-geofenceerrorevent-error">#dom-geofenceerrorevent-error</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofenceerrorevent-error-1">4.2. GeofenceManager interface</a></span><span><a href="#ref-for-dom-geofenceerrorevent-error-2">4.6.2. GeofenceErrorEvent</a></span></span></dfn>;
  readonly attribute DOMString <dfn class="dfn-paneled idl-code" data-dfn-for="GeofenceErrorEvent" data-dfn-type="attribute" data-export="" data-lt="message" data-readonly="" data-type="DOMString " id="dom-geofenceerrorevent-message">message<span class="dfn-panel" data-deco=""><b><a href="#dom-geofenceerrorevent-message">#dom-geofenceerrorevent-message</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-geofenceerrorevent-message-1">4.6.2. GeofenceErrorEvent</a></span></span></dfn>;
};
</pre>
      <p>When a <a data-link-type="dfn" href="#geofence-term" id="ref-for-geofence-term-24">geofence</a> <var>geofence</var> is <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="deactivated" data-noexport="" id="deactivated">deactivated<span class="dfn-panel" data-deco=""><b><a href="#deactivated">#deactivated</a></b><b>Referenced in:</b><span><a href="#ref-for-deactivated-1">3.1. 
      Privacy considerations for implementers of the Geofencing API </a> <a href="#ref-for-deactivated-2">(2)</a></span><span><a href="#ref-for-deactivated-3">4.3. Geofence interface</a></span></span></dfn>, the <a data-link-type="dfn" href="#user-agent" id="ref-for-user-agent-17">user agent</a> SHOULD run the following steps:</p>
      <ol>
       <li> Let <var>serviceWorkerRegistration</var> be the <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a> <var>geofence</var> is associated with. 
       <li> Let <var>oldState</var> be the <a data-link-type="dfn" href="#state" id="ref-for-state-5">state</a> of <var>geofence</var>. 
       <li> Set the <a data-link-type="dfn" href="#state" id="ref-for-state-6">state</a> of <var>geofence</var> to <a data-link-type="dfn" href="#inactive" id="ref-for-inactive-3">inactive</a>. 
       <li>
         If <var>oldState</var> is <a data-link-type="dfn" href="#active" id="ref-for-active-4">active</a>, invoke the <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#handle-functional-event-algorithm">Handle Functional Event</a> algorithm with <var>serviceWorkerRegistration</var> and the algorithm represented by
          the following substeps as arguments. 
        <ol>
         <li> Let <var>globalObject</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object">global object</a> these steps are invoked with. 
         <li> Create a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-events-trusted">trusted</a> event <var>event</var> that uses the <code class="idl"><a data-link-type="idl" href="#geofenceerrorevent" id="ref-for-geofenceerrorevent-3">GeofenceErrorEvent</a></code> interface, with event type <code><a data-link-type="dfn" href="#geofenceerror" id="ref-for-geofenceerror-2">geofenceerror</a></code>. 
         <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceerrorevent-geofence" id="ref-for-dom-geofenceerrorevent-geofence-2">geofence</a></code> atrribute of <var>event</var> be initialized to
              a new <code class="idl"><a data-link-type="idl" href="#geofence" id="ref-for-geofence-14">Geofence</a></code> instance representing <var>geofence</var>. 
         <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceerrorevent-error" id="ref-for-dom-geofenceerrorevent-error-2">error</a></code> attribute of <var>event</var> be initialized to
              an error name. 
         <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceerrorevent-message" id="ref-for-dom-geofenceerrorevent-message-1">message</a></code> attribute of <var>event</var> be initialized to
              a descriptive message for the error that occurred. 
         <li> Dispatch <var>event</var> at <var>globalObject</var>. 
        </ol>
      </ol>
     </section>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="exceptions"><span class="secno">5. </span><span class="content">Exceptions</span><a class="self-link" href="#exceptions"></a></h2>
    <p>The Geofencing API uses the new <code><dfn data-dfn-type="dfn" data-noexport="" exception="" id="permissiondeniederror">PermissionDeniedError<a class="self-link" href="#permissiondeniederror"></a></dfn></code> <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException-error-names">DOMException</a></code> name.</p>
   </section>
  </main>
  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
  <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>
  <p>This specification defines conformance criteria that apply to a single product: the <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="user agent" data-noexport="" id="user-agent">user agent<span class="dfn-panel" data-deco=""><b><a href="#user-agent">#user-agent</a></b><b>Referenced in:</b><span><a href="#ref-for-user-agent-1">1. Introduction</a></span><span><a href="#ref-for-user-agent-2">2. Model</a> <a href="#ref-for-user-agent-3">(2)</a></span><span><a href="#ref-for-user-agent-4">2.1. Implementation considerations</a> <a href="#ref-for-user-agent-5">(2)</a></span><span><a href="#ref-for-user-agent-6">3.1. 
      Privacy considerations for implementers of the Geofencing API </a> <a href="#ref-for-user-agent-7">(2)</a> <a href="#ref-for-user-agent-8">(3)</a> <a href="#ref-for-user-agent-9">(4)</a> <a href="#ref-for-user-agent-10">(5)</a></span><span><a href="#ref-for-user-agent-11">4.2. GeofenceManager interface</a> <a href="#ref-for-user-agent-12">(2)</a></span><span><a href="#ref-for-user-agent-13">4.3. Geofence interface</a> <a href="#ref-for-user-agent-14">(2)</a></span><span><a href="#ref-for-user-agent-15">4.6.1. 
        The geofenceenter and geofenceleave events </a> <a href="#ref-for-user-agent-16">(2)</a></span><span><a href="#ref-for-user-agent-17">4.6.2. GeofenceErrorEvent</a></span></span></dfn> that implements the interfaces that it contains. </p>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words “MUST”,
    “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
    “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text with <code>class="example"</code>,
    like this: </p>
  <div class="example" id="example-f839f6c8">
   <a class="self-link" href="#example-f839f6c8"></a> 
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word “Note” and are set apart from the
    normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>
  <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>
  <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#active">active</a><span>, in §2</span>
   <li><a href="#dom-geofencemanager-add">add(initialRegion)</a><span>, in §4.2</span>
   <li><a href="#dom-geofencemanager-add">add(initialRegion, options)</a><span>, in §4.2</span>
   <li><a href="#breached">breached</a><span>, in §2</span>
   <li><a href="#circulargeofenceregion">CircularGeofenceRegion</a><span>, in §4.5</span>
   <li><a href="#dom-circulargeofenceregion-circulargeofenceregion">CircularGeofenceRegion(init)</a><span>, in §4.5</span>
   <li><a href="#dictdef-circulargeofenceregioninit">CircularGeofenceRegionInit</a><span>, in §4.5</span>
   <li><a href="#deactivated">deactivated</a><span>, in §4.6.2</span>
   <li><a href="#enter-event">enter event</a><span>, in §2</span>
   <li><a href="#dom-geofenceerrorevent-error">error</a><span>, in §4.6.2</span>
   <li><a href="#fire-a-geofence-event">fire a geofence event</a><span>, in §4.6.1</span>
   <li>
    geofence
    <ul>
     <li><a href="#geofence-term">definition of</a><span>, in §2</span>
     <li><a href="#dom-geofenceevent-geofence">attribute for GeofenceEvent</a><span>, in §4.6.1</span>
     <li><a href="#dom-geofenceerrorevent-geofence">attribute for GeofenceErrorEvent</a><span>, in §4.6.2</span>
    </ul>
   <li><a href="#geofence">Geofence</a><span>, in §4.3</span>
   <li><a href="#geofenceenter">geofenceenter</a><span>, in §4.6</span>
   <li><a href="#geofenceerror">geofenceerror</a><span>, in §4.6</span>
   <li><a href="#geofenceerrorevent">GeofenceErrorEvent</a><span>, in §4.6.2</span>
   <li><a href="#geofenceevent">GeofenceEvent</a><span>, in §4.6.1</span>
   <li><a href="#geofence-id">geofence ID</a><span>, in §2</span>
   <li><a href="#geofenceleave">geofenceleave</a><span>, in §4.6</span>
   <li><a href="#geofence-limit">geofence limit</a><span>, in §2.1</span>
   <li><a href="#geofencemanager">GeofenceManager</a><span>, in §4.2</span>
   <li><a href="#geofence-name">geofence name</a><span>, in §2</span>
   <li><a href="#dictdef-geofenceoptions">GeofenceOptions</a><span>, in §4.2</span>
   <li><a href="#dictdef-geofencequeryoptions">GeofenceQueryOptions</a><span>, in §4.2</span>
   <li><a href="#geofenceregion">GeofenceRegion</a><span>, in §4.4</span>
   <li><a href="#dictdef-geofenceregioninit">GeofenceRegionInit</a><span>, in §4.4</span>
   <li><a href="#dom-serviceworkerregistration-geofencing">geofencing</a><span>, in §4.1</span>
   <li><a href="#geographic-coordinate">geographic coordinate</a><span>, in §2</span>
   <li><a href="#geographic-region">geographic region</a><span>, in §2</span>
   <li><a href="#dom-geofencemanager-getall">getAll()</a><span>, in §4.2</span>
   <li><a href="#dom-geofencemanager-getall">getAll(options)</a><span>, in §4.2</span>
   <li><a href="#dom-geofencemanager-getbyid">getById(id)</a><span>, in §4.2</span>
   <li><a href="#dom-geofence-id">id</a><span>, in §4.3</span>
   <li><a href="#inactive">inactive</a><span>, in §2</span>
   <li><a href="#dom-geofenceoptions-includeposition">includePosition</a><span>, in §4.2</span>
   <li><a href="#include-position">include position</a><span>, in §2</span>
   <li>
    latitude
    <ul>
     <li><a href="#dom-circulargeofenceregioninit-latitude">dict-member for CircularGeofenceRegionInit</a><span>, in §4.5</span>
     <li><a href="#dom-circulargeofenceregion-latitude">attribute for CircularGeofenceRegion</a><span>, in §4.5</span>
    </ul>
   <li><a href="#leave-event">leave
  event</a><span>, in §2</span>
   <li><a href="#list-of-geofences">list of geofences</a><span>, in §2</span>
   <li>
    longitude
    <ul>
     <li><a href="#dom-circulargeofenceregioninit-longitude">dict-member for CircularGeofenceRegionInit</a><span>, in §4.5</span>
     <li><a href="#dom-circulargeofenceregion-longitude">attribute for CircularGeofenceRegion</a><span>, in §4.5</span>
    </ul>
   <li><a href="#dom-geofenceerrorevent-message">message</a><span>, in §4.6.2</span>
   <li>
    name
    <ul>
     <li><a href="#dom-geofencequeryoptions-name">dict-member for GeofenceQueryOptions</a><span>, in §4.2</span>
     <li><a href="#dom-geofenceregioninit-name">dict-member for GeofenceRegionInit</a><span>, in §4.4</span>
     <li><a href="#dom-geofenceregion-name">attribute for GeofenceRegion</a><span>, in §4.4</span>
    </ul>
   <li><a href="#name-limit">name limit</a><span>, in §2.1</span>
   <li><a href="#dom-serviceworkerglobalscope-ongeofenceenter">ongeofenceenter</a><span>, in §4.6</span>
   <li><a href="#dom-serviceworkerglobalscope-ongeofenceerror">ongeofenceerror</a><span>, in §4.6</span>
   <li><a href="#dom-serviceworkerglobalscope-ongeofenceleave">ongeofenceleave</a><span>, in §4.6</span>
   <li><a href="#permissiondeniederror">PermissionDeniedError</a><span>, in §5</span>
   <li><a href="#dom-geofenceevent-position">position</a><span>, in §4.6.1</span>
   <li>
    radius
    <ul>
     <li><a href="#radius">definition of</a><span>, in §2</span>
     <li><a href="#dom-circulargeofenceregioninit-radius">dict-member for CircularGeofenceRegionInit</a><span>, in §4.5</span>
     <li><a href="#dom-circulargeofenceregion-radius">attribute for CircularGeofenceRegion</a><span>, in §4.5</span>
    </ul>
   <li><a href="#dom-geofence-region">region</a><span>, in §4.3</span>
   <li><a href="#dom-geofence-remove">remove()</a><span>, in §4.3</span>
   <li><a href="#state">state</a><span>, in §2</span>
   <li><a href="#user-agent">user agent</a><span>, in §Unnumbered section</span>
   <li><a href="#webapp">webapp</a><span>, in §2</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[WebIDL-1]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#idl-DOMException-error-names">DOMException</a>
     <li><a href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>
    </ul>
   <li>
    <a data-link-type="biblio">[ECMASCRIPT]</a> defines the following terms:
    <ul>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-rangeerror">RangeError</a>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-typeerror">TypeError</a>
    </ul>
   <li>
    <a data-link-type="biblio">[GEOLOCATION-API]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/geolocation-API/#position_interface">Position</a>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event type</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handlers</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object">global object</a>
     <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>
     <li><a href="https://html.spec.whatwg.org/#concept-events-trusted">trusted</a>
    </ul>
   <li>
    <a data-link-type="biblio">[powerful-features]</a> defines the following terms:
    <ul>
     <li><a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">secure context</a>
    </ul>
   <li>
    <a data-link-type="biblio">[promises-guide]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a>
    </ul>
   <li>
    <a data-link-type="biblio">[service-workers]</a> defines the following terms:
    <ul>
     <li><a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#extendable-event-interface">ExtendableEvent</a>
     <li><a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-global-scope-interface">ServiceWorkerGlobalScope</a>
     <li><a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a>
     <li><a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#handle-functional-event-algorithm">handle functional event</a>
     <li><a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-ecmascript">[ECMASCRIPT]
   <dd><a href="https://tc39.github.io/ecma262/">ECMAScript Language Specification</a>. URL: <a href="https://tc39.github.io/ecma262/">https://tc39.github.io/ecma262/</a>
   <dt id="biblio-geolocation-api">[GEOLOCATION-API]
   <dd>Andrei Popescu. <a href="http://dev.w3.org/geo/api/spec-source.html">Geolocation API Specification</a>. 28 May 2015. PER. URL: <a href="http://dev.w3.org/geo/api/spec-source.html">http://dev.w3.org/geo/api/spec-source.html</a>
   <dt id="biblio-html">[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-powerful-features">[POWERFUL-FEATURES]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/">Secure Contexts</a>. 13 April 2016. WD. URL: <a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/">https://w3c.github.io/webappsec/specs/powerfulfeatures/</a>
   <dt id="biblio-promises-guide">[PROMISES-GUIDE]
   <dd><a href="https://www.w3.org/2001/tag/doc/promises-guide">Writing Promise-Using Specifications</a>. 24 July 2015. Finding of the W3C TAG. URL: <a href="https://www.w3.org/2001/tag/doc/promises-guide">https://www.w3.org/2001/tag/doc/promises-guide</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-service-workers">[SERVICE-WORKERS]
   <dd>Alex Russell; Jungkee Song; Jake Archibald. <a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/">Service Workers</a>. 25 June 2015. WD. URL: <a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/">https://slightlyoff.github.io/ServiceWorker/spec/service_worker/</a>
   <dt id="biblio-webidl-1">[WebIDL-1]
   <dd>Cameron McCormack; Boris Zbarsky. <a href="https://heycam.github.io/webidl/">WebIDL Level 1</a>. 8 March 2016. CR. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-wgs84">[WGS84]
   <dd><a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf">National Imagery and Mapping Agency Technical Report 8350.2, Third Edition</a>. 3 January 2000. URL: <a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf">http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl def">partial interface <a class="idl-code" data-link-type="interface" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofencemanager">GeofenceManager</a> <a data-readonly="" data-type="GeofenceManager " href="#dom-serviceworkerregistration-geofencing">geofencing</a>;
};

[NoInterfaceObject]
interface <a href="#geofencemanager">GeofenceManager</a> {
  Promise&lt;<a data-link-type="idl-name" href="#geofence">Geofence</a>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-add">add</a>(<a data-link-type="idl-name" href="#geofenceregion">GeofenceRegion</a> <a href="#dom-geofencemanager-add-initialregion-options-initialregion">initialRegion</a>, optional <a data-link-type="idl-name" href="#dictdef-geofenceoptions">GeofenceOptions</a> <a href="#dom-geofencemanager-add-initialregion-options-options">options</a>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#geofence">Geofence</a>>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-getall">getAll</a>(optional <a data-link-type="idl-name" href="#dictdef-geofencequeryoptions">GeofenceQueryOptions</a> <a href="#dom-geofencemanager-getall-options-options">options</a>);
  Promise&lt;<a data-link-type="idl-name" href="#geofence">Geofence</a>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-getbyid">getById</a>(DOMString <a href="#dom-geofencemanager-getbyid-id-id">id</a>);
};

dictionary <a href="#dictdef-geofenceoptions">GeofenceOptions</a> {
  boolean <a class="idl-code" data-default="false" data-link-type="dict-member" data-type="boolean " href="#dom-geofenceoptions-includeposition">includePosition</a> = false;
};

dictionary <a href="#dictdef-geofencequeryoptions">GeofenceQueryOptions</a> {
  DOMString? <a data-type="DOMString? " href="#dom-geofencequeryoptions-name">name</a>;
};

[Exposed=(Window,Worker)]
interface <a href="#geofence">Geofence</a> {
  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-geofence-id">id</a>;
  readonly attribute <a data-link-type="idl-name" href="#geofenceregion">GeofenceRegion</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="GeofenceRegion " href="#dom-geofence-region">region</a>;
  Promise&lt;boolean> <a class="idl-code" data-link-type="method" href="#dom-geofence-remove">remove</a>();
};

[Exposed=(Window,Worker)]
interface <a href="#geofenceregion">GeofenceRegion</a> {
  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-geofenceregion-name">name</a>;
};

dictionary <a href="#dictdef-geofenceregioninit">GeofenceRegionInit</a> {
  DOMString? <a data-type="DOMString? " href="#dom-geofenceregioninit-name">name</a>;
};

[<a href="#dom-circulargeofenceregion-circulargeofenceregion">Constructor</a>(<a data-link-type="idl-name" href="#dictdef-circulargeofenceregioninit">CircularGeofenceRegionInit</a> <a href="#dom-circulargeofenceregion-circulargeofenceregion-init-init">init</a>), Exposed=(Window,Worker)]
interface <a href="#circulargeofenceregion">CircularGeofenceRegion</a> : <a data-link-type="idl-name" href="#geofenceregion">GeofenceRegion</a> {
  readonly attribute double <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="double " href="#dom-circulargeofenceregion-latitude">latitude</a>;
  readonly attribute double <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="double " href="#dom-circulargeofenceregion-longitude">longitude</a>;
  readonly attribute double <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="double " href="#dom-circulargeofenceregion-radius">radius</a>;
};

dictionary <a href="#dictdef-circulargeofenceregioninit">CircularGeofenceRegionInit</a> : <a data-link-type="idl-name" href="#dictdef-geofenceregioninit">GeofenceRegionInit</a> {
  double <a data-type="double " href="#dom-circulargeofenceregioninit-latitude">latitude</a>;
  double <a data-type="double " href="#dom-circulargeofenceregioninit-longitude">longitude</a>;
  double <a data-type="double " href="#dom-circulargeofenceregioninit-radius">radius</a>;
};

partial interface <a class="idl-code" data-link-type="interface" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-global-scope-interface">ServiceWorkerGlobalScope</a> {
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceenter">ongeofenceenter</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceleave">ongeofenceleave</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceerror">ongeofenceerror</a>;
};

[Exposed=ServiceWorker]
interface <a href="#geofenceevent">GeofenceEvent</a> : <a data-link-type="idl-name" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#extendable-event-interface">ExtendableEvent</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofence">Geofence</a> <a data-readonly="" data-type="Geofence " href="#dom-geofenceevent-geofence">geofence</a>;
  readonly attribute <a data-link-type="idl-name" href="http://www.w3.org/TR/geolocation-API/#position_interface">Position</a>? <a data-readonly="" data-type="Position? " href="#dom-geofenceevent-position">position</a>;
};

[Exposed=ServiceWorker]
interface <a href="#geofenceerrorevent">GeofenceErrorEvent</a> : <a data-link-type="idl-name" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#extendable-event-interface">ExtendableEvent</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofence">Geofence</a> <a data-readonly="" data-type="Geofence " href="#dom-geofenceerrorevent-geofence">geofence</a>;
  readonly attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-geofenceerrorevent-error">error</a>;
  readonly attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-geofenceerrorevent-message">message</a>;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> This should somehow mention how the [permissions] API is related to this.<a href="#issue-4cdf3c60"> ↵ </a></div>
   <div class="issue"> Somehow mention that the region that is saved as part of the registration can be slightly
    different from the region passed to register. An implementation may adjust parameters to
    be in range of what is possible, or otherwise modify the region.<a href="#issue-8ae02316"> ↵ </a></div>
  </div>
<script>
        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            while(el.parentElement) {
                if(el.tagName == "DFN") {
                    target = "dfn";
                    break;
                }
                if(/H\d/.test(el.tagName) && el.getAttribute('data-dfn-type') != null) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn") {
                // open the panel
                var dfnPanel = el.querySelector(".dfn-panel");
                if(dfnPanel) {
                    dfnPanel.classList.add("on");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
            }

        });
        </script>